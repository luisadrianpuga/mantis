mermaid
flowchart LR

%% Clients
subgraph Clients
UI[Web UI / CLI / Integrations]
end

%% API Layer
subgraph API Layer
API[OpenAI-Compatible API]
Auth[Config & Provider Manager]
end

%% Core Runtime
subgraph Mantis Runtime
Orchestrator[Task Orchestrator]
AgentLoop[Agent Runtime Loop]
Prompt[Prompt Builder]
MemoryMgr[Memory Manager]
ToolBus[Tool Bus]
Scheduler[Task Scheduler]
end

%% Model Providers
subgraph Model Providers
OpenAI[OpenAI Adapter]
Claude[Claude Adapter]
LocalLLM[Local LLM Adapter]
end

%% Memory Layer
subgraph Memory Layer
VectorDB[(Vector Database)]
FileStore[(Workspace Files)]
end

%% Tools Layer
subgraph Tools
Python[Python Executor]
Browser[Browser Automation]
HTTP[HTTP / API Client]
Shell[Shell Commands]
end

%% External World
subgraph External Services
Internet[Web Services]
Apps[External Apps / APIs]
end

%% Flow connections
UI --> API
API --> Auth
API --> Orchestrator

Auth --> OpenAI
Auth --> Claude
Auth --> LocalLLM

Orchestrator --> AgentLoop
AgentLoop --> Prompt
AgentLoop --> MemoryMgr
AgentLoop --> ToolBus
AgentLoop --> Scheduler

Prompt --> OpenAI
Prompt --> Claude
Prompt --> LocalLLM

MemoryMgr --> VectorDB
MemoryMgr --> FileStore

ToolBus --> Python
ToolBus --> Browser
ToolBus --> HTTP
ToolBus --> Shell

Browser --> Internet
HTTP --> Apps

Python --> AgentLoop
Browser --> AgentLoop
HTTP --> AgentLoop
Shell --> AgentLoop

OpenAI --> AgentLoop
Claude --> AgentLoop
LocalLLM --> AgentLoop
